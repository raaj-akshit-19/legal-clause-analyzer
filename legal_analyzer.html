<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legal Clause Analyzer</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">

    <!-- PDF Generation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- DOCX Generation Library -->
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        :root {
            /* Instagram-like Dark Theme Palette */
            --primary-gradient: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            --secondary-gradient: linear-gradient(135deg, #405de6 0%, #5851db 100%);

            --background-color: #000000;
            --surface-color: #121212;
            --surface-hover: #1a1a1a;
            --border-color: #262626;

            --text-primary: #fafafa;
            --text-secondary: #a8a8a8;

            /* Status Colors (Dark Mode Adapted) */
            --condition-border: #405de6;
            /* Instagram Blue */
            --condition-bg: rgba(64, 93, 230, 0.15);
            --condition-text: #8eaafc;

            --exception-border: #fd1d1d;
            /* Instagram Red */
            --exception-bg: rgba(253, 29, 29, 0.15);
            --exception-text: #ff8a8a;

            --conditional-border: #fca311;
            /* Amber */
            --conditional-bg: rgba(252, 163, 17, 0.15);
            --conditional-text: #fcd386;

            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.5);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
            --shadow-glow: 0 0 30px rgba(188, 24, 136, 0.2);
            /* Pink glow */

            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            /* Subtle background mesh */
            background-image:
                radial-gradient(circle at 15% 50%, rgba(131, 58, 180, 0.08) 0%, transparent 25%),
                radial-gradient(circle at 85% 30%, rgba(253, 29, 29, 0.08) 0%, transparent 25%);
        }

        .container {
            width: 100%;
            max-width: 900px;
            position: relative;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        header h1 {
            font-family: 'Outfit', sans-serif;
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.03em;
            /* Add drop shadow to make text pop on dark bg */
            filter: drop-shadow(0 2px 10px rgba(220, 39, 67, 0.3));
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.125rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Dark Glassmorphic Input Section */
        .glass-panel {
            background: rgba(30, 30, 30, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-lg), var(--shadow-glow);
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .glass-panel:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg), 0 0 40px rgba(188, 24, 136, 0.25);
            border-color: rgba(255, 255, 255, 0.15);
        }

        .input-wrapper {
            position: relative;
            margin-bottom: 1.5rem;
        }

        textarea {
            width: 100%;
            height: 180px;
            padding: 1.25rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            line-height: 1.5;
            resize: vertical;
            outline: none;
            transition: all 0.2s ease;
            background-color: rgba(0, 0, 0, 0.3);
            color: var(--text-primary);
        }

        textarea:focus {
            border-color: #833ab4;
            /* Instagram Purple */
            background-color: #000;
            box-shadow: 0 0 0 2px rgba(131, 58, 180, 0.3);
        }

        textarea::placeholder {
            color: #555;
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        button {
            padding: 0.875rem 1.75rem;
            border-radius: var(--radius-lg);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            font-family: 'Outfit', sans-serif;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(220, 39, 67, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(220, 39, 67, 0.5);
            filter: brightness(1.1);
        }

        .btn-secondary {
            background-color: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(5px);
        }

        .btn-secondary:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-color: #555;
            color: #fff;
        }

        /* Results Section */
        .results-section {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            pointer-events: none;
        }

        .results-section.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 0 0.5rem;
        }

        .results-header h2 {
            font-family: 'Outfit', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .clause-grid {
            display: grid;
            gap: 1.25rem;
        }

        .clause-card {
            background: var(--surface-color);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            border-left: 4px solid transparent;
            animation: slideIn 0.5s ease-out forwards;
            opacity: 0;
            transform: translateX(-10px);
            transition: transform 0.2s, background-color 0.2s;
        }

        .clause-card:hover {
            transform: translateY(-2px);
            background-color: var(--surface-hover);
        }

        .clause-card[data-type="Condition Clause"] {
            border-left-color: var(--condition-border);
        }

        .clause-card[data-type="Exception Clause"] {
            border-left-color: var(--exception-border);
        }

        .clause-card[data-type="Conditional Clause"] {
            border-left-color: var(--conditional-border);
        }

        .clause-badge {
            display: inline-block;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            padding: 0.35rem 0.75rem;
            border-radius: 99px;
            margin-bottom: 1rem;
        }

        .clause-card[data-type="Condition Clause"] .clause-badge {
            background: var(--condition-bg);
            color: var(--condition-text);
        }

        .clause-card[data-type="Exception Clause"] .clause-badge {
            background: var(--exception-bg);
            color: var(--exception-text);
        }

        .clause-card[data-type="Conditional Clause"] .clause-badge {
            background: var(--conditional-bg);
            color: var(--conditional-text);
        }

        .clause-detail {
            display: grid;
            gap: 1rem;
        }

        .detail-item strong {
            display: block;
            font-size: 0.7rem;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 0.4rem;
            font-weight: 600;
            letter-spacing: 0.05em;
        }

        .detail-item p {
            color: var(--text-primary);
            font-size: 1rem;
            font-weight: 400;
        }

        /* Icons */
        .icon {
            width: 20px;
            height: 20px;
        }

        /* Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Footer */
        footer {
            margin-top: 4rem;
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.875rem;
            opacity: 0.5;
        }
    </style>
</head>

<body>

    <div class="container">
        <header>
            <h1>Legal Clause Analyzer</h1>
            <p>Paste your legal document below to instantly identify conditions, exceptions, and obligations using
                advanced pattern matching.</p>
        </header>

        <section class="glass-panel">
            <div class="input-wrapper">
                <textarea id="legal-text"
                    placeholder="Example: If the tenant fails to pay rent within 5 days, the landlord may terminate the agreement. The tenant shall maintain the property, unless specifically exempted."></textarea>
            </div>
            <div class="btn-group">
                <button id="clear-btn" class="btn-secondary">
                    <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                        </path>
                    </svg>
                    Clear Text
                </button>
                <button id="analyze-btn" class="btn-primary">
                    <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                        </path>
                    </svg>
                    Analyze Document
                </button>
            </div>
        </section>

        <div id="results-section" class="results-section">
            <div class="results-header">
                <h2>Analysis Results</h2>
                <div class="btn-group" style="gap: 0.5rem;">
                    <button id="download-pdf" class="btn-secondary" style="font-size: 0.875rem; padding: 0.5rem 1rem;">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                            </path>
                        </svg>
                        Export PDF
                    </button>
                    <button id="download-docx" class="btn-secondary" style="font-size: 0.875rem; padding: 0.5rem 1rem;">
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z">
                            </path>
                        </svg>
                        Export DOCX
                    </button>
                </div>
            </div>
            <div id="clause-grid" class="clause-grid">
                <!-- Results injected here -->
            </div>
        </div>

        <footer>
            <p>&copy; 2026 Legal Clause Analyzer AI. Runs entirely in your browser.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const analyzeBtn = document.getElementById('analyze-btn');
            const clearBtn = document.getElementById('clear-btn');
            const legalText = document.getElementById('legal-text');
            const resultsSection = document.getElementById('results-section');
            const clauseGrid = document.getElementById('clause-grid');
            const downloadPdfBtn = document.getElementById('download-pdf');
            const downloadDocxBtn = document.getElementById('download-docx');

            let currentResults = [];

            // Pattern Matching Logic (Ported from Python)
            const analyzeText = (text) => {
                const clauses = [];

                // Helper for regex matching
                const findMatches = (regex, type) => {
                    let match;
                    while ((match = regex.exec(text)) !== null) {
                        clauses.push({
                            type: type,
                            condition: match[1].trim(),
                            consequence: match[2].trim()
                        });
                    }
                };

                // Condition Clause: "if/in case ... then/,"
                findMatches(/\b(?:if|in case)\b (.*?)(?:,| then | may | shall | will )(.*?)(?:\.|;|$)/gi, "Condition Clause");

                // Exception Clause: "unless ... ,"
                findMatches(/\bunless\b (.*?)(?:,| may | shall | will )(.*?)(?:\.|;|$)/gi, "Exception Clause");

                // Conditional Clause: "provided that ... ,"
                findMatches(/\bprovided that\b (.*?)(?:,| may | shall | will )(.*?)(?:\.|;|$)/gi, "Conditional Clause");

                return clauses;
            };

            analyzeBtn.addEventListener('click', () => {
                const text = legalText.value.trim();
                if (!text) {
                    alert('Please enter some text to analyze.');
                    return;
                }

                analyzeBtn.textContent = 'Processing...';

                // Simulate small delay for UX
                setTimeout(() => {
                    currentResults = analyzeText(text);
                    displayResults(currentResults);
                    analyzeBtn.innerHTML = `
                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                        Analyze Document`;
                }, 500);
            });

            clearBtn.addEventListener('click', () => {
                legalText.value = '';
                resultsSection.classList.remove('visible');
                setTimeout(() => {
                    clauseGrid.innerHTML = '';
                    currentResults = [];
                }, 300);
            });

            const displayResults = (clauses) => {
                clauseGrid.innerHTML = '';

                if (clauses.length === 0) {
                    clauseGrid.innerHTML = '<div style="text-align:center; padding: 2rem; color: var(--text-secondary);">No clauses found matching standard patterns.</div>';
                } else {
                    clauses.forEach((clause, index) => {
                        const card = document.createElement('div');
                        card.className = 'clause-card';
                        card.setAttribute('data-type', clause.type);
                        card.style.animationDelay = `${index * 100}ms`;

                        card.innerHTML = `
                            <span class="clause-badge">${clause.type}</span>
                            <div class="clause-detail">
                                <div class="detail-item">
                                    <strong>Condition</strong>
                                    <p>${clause.condition}</p>
                                </div>
                                <div class="detail-item">
                                    <strong>Consequence</strong>
                                    <p>${clause.consequence}</p>
                                </div>
                            </div>
                        `;
                        clauseGrid.appendChild(card);
                    });
                }

                resultsSection.classList.add('visible');
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            };

            // PDF Generation
            downloadPdfBtn.addEventListener('click', async () => {
                if (currentResults.length === 0) return;

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                doc.setFont("helvetica", "bold");
                doc.setFontSize(20);
                doc.setTextColor(33, 33, 33);
                doc.text("Legal Clause Analysis Report", 20, 20);

                doc.setFontSize(10);
                doc.setTextColor(100, 100, 100);
                doc.text(`Generated on ${new Date().toLocaleDateString()}`, 20, 28);

                let y = 40;

                currentResults.forEach(clause => {
                    if (y > 270) {
                        doc.addPage();
                        y = 20;
                    }

                    doc.setFont("helvetica", "bold");
                    doc.setFontSize(12);
                    doc.setTextColor(79, 70, 229); // Primary color
                    doc.text(clause.type, 20, y);
                    y += 7;

                    doc.setFont("helvetica", "normal");
                    doc.setFontSize(11);
                    doc.setTextColor(0, 0, 0);

                    const conditionText = `Condition: ${clause.condition}`;
                    const consequenceText = `Consequence: ${clause.consequence}`;

                    const splitCondition = doc.splitTextToSize(conditionText, 170);
                    doc.text(splitCondition, 20, y);
                    y += splitCondition.length * 5;

                    const splitConsequence = doc.splitTextToSize(consequenceText, 170);
                    doc.text(splitConsequence, 20, y);
                    y += splitConsequence.length * 5 + 10;
                });

                doc.save("legal_analysis_report.pdf");
            });

            // DOCX Generation
            downloadDocxBtn.addEventListener('click', () => {
                if (currentResults.length === 0) return;

                const { Paragraph, Document, Packer, TextRun, HeadingLevel } = docx;

                const children = [
                    new Paragraph({
                        text: "Legal Clause Analysis Report",
                        heading: HeadingLevel.TITLE,
                    }),
                    new Paragraph({
                        text: `Generated on ${new Date().toLocaleDateString()}`,
                        spacing: { after: 200 },
                    }),
                ];

                currentResults.forEach(clause => {
                    children.push(
                        new Paragraph({
                            children: [
                                new TextRun({
                                    text: clause.type,
                                    bold: true,
                                    color: "2E75B6",
                                    size: 28,
                                }),
                            ],
                            spacing: { before: 200, after: 100 },
                        }),
                        new Paragraph({
                            children: [
                                new TextRun({ text: "Condition: ", bold: true }),
                                new TextRun(clause.condition),
                            ],
                        }),
                        new Paragraph({
                            children: [
                                new TextRun({ text: "Consequence: ", bold: true }),
                                new TextRun(clause.consequence),
                            ],
                            spacing: { after: 200 },
                        })
                    );
                });

                const doc = new Document({
                    sections: [{
                        properties: {},
                        children: children,
                    }],
                });

                Packer.toBlob(doc).then(blob => {
                    saveAs(blob, "legal_analysis_report.docx");
                });
            });
        });
    </script>
</body>

</html>
